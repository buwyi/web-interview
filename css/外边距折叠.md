## 外边距折叠

## ✅ 一、什么是 Margin Collapse（外边距折叠）

> 当两个垂直方向的块级元素的 margin（外边距）相遇时，它们不会简单地相加，而是发生“折叠”：取它们中**较大的那一个**作为合并后的结果。

这种现象常发生在以下几种情况：

---

## ✅ 二、常见的 Margin Collapse 场景

### 🔷 1. **父子元素之间的 margin-top 折叠**

* 子元素的 `margin-top` 会和父元素的 `margin-top` 折叠
* 条件：父元素没有边框、内边距、高度、BFC、inline 内容等

```html
<div class="parent">
  <div class="child"></div>
</div>
```

```css
.parent {
  background: #eee;
}

.child {
  margin-top: 50px;
  height: 100px;
  background: red;
}
```

在这个例子中，如果 `.parent` 没有设置 `padding`, `border`, `height`, `overflow`, `min-height` 等属性，那么 `.child` 的 `margin-top` 会穿透 `.parent`，直接作用于 `.parent` 的外部。

> ✅ **解决方法：**
>
> * 给 `.parent` 加 `padding-top: 1px`、`border-top: 1px solid transparent`、`overflow: hidden` 等任意一个都能阻止 margin 折叠。

---

### 🔷 2. **相邻兄弟元素之间的 margin-top 与 margin-bottom 折叠**

```html
<div class="box1"></div>
<div class="box2"></div>
```

```css
.box1 {
  margin-bottom: 40px;
  height: 100px;
  background: blue;
}

.box2 {
  margin-top: 30px;
  height: 100px;
  background: green;
}
```

两者垂直方向相邻，`margin-bottom: 40px` 与 `margin-top: 30px` 会折叠为 `40px`（取较大值），不是相加的 70px。

---

### 🔷 3. **空块元素的上下 margin 折叠**

如果一个块元素本身没有内容，没有 padding、border，也没有高度，它的 `margin-top` 和 `margin-bottom` 会**相互折叠**。

---

## ✅ 三、如何阻止 Margin Collapse（核心点）

根据你提供的原文总结，**父元素要阻止与子元素之间的 margin 折叠，需满足以下任一条件**：

| 条件               | 描述                                          |
| ---------------- | ------------------------------------------- |
| 设定边框             | `border-top` 或 `border-bottom`              |
| 设定内边距            | `padding-top` 或 `padding-bottom`            |
| 设置高度或 min-height | `height` / `min-height`                     |
| 创建 BFC           | 如：`overflow: hidden`、`display: flow-root` 等 |
| 插入行级内容           | 如在父容器中加空格、`<span>`                          |
| 设置间隙             | 使用 `gap` 属性（在 `flex` 或 `grid` 中）            |

---

## ✅ 四、建议用法（解决方式）

* **最推荐方式：创建 BFC**

  ```css
  .parent {
    overflow: hidden; /* 触发 BFC，最稳妥 */
  }
  ```

* 或者：

  ```css
  .parent {
    padding-top: 1px; /* 加一个轻微 padding 就可阻止折叠 */
  }
  ```

* **现代方案（推荐）**

  ```css
  .parent {
    display: flow-root; /* 现代方式触发 BFC，语义清晰 */
  }
  ```

---

## ✅ 五、总结一句话：

> ❗ **当父元素没有边框、padding、高度、内容或没有创建 BFC 时，子元素的 `margin` 会“穿透”父元素发生外边距折叠，导致视觉偏差或布局异常。**

如果你希望我结合某段代码分析具体的折叠问题，我可以帮助你调试或给出最优化的 CSS 写法。
