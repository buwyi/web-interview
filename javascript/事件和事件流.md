## 事件和事件流

事件指用户或者浏览器在页面中触发的某些行为，例如：

- 用户行为：click, input, mouseover, keydown
- 浏览器行为： load, resize, scroll
  当这些行为发生，浏览器会生成**事件对象(object event)** ，并且派发到页面元素上，可以通过事件监听器捕获并且处理它。

事件还分为原始事件模型和标准事件模型，以及 IE 事件模型

- 原始事件模型(DOM0 级)
  例如`button.onclick`只支持冒泡环节，不支持捕获环节，只能绑定一次，后续绑定覆盖前面绑定
- 标准事件模型(DOM2 级)
  正常为

### 事件流（Event Flow）

事件在 DOM 中的传播过程称为**事件流**。W3C 定义了三阶段：

### DOM 事件流的三个阶段

```
1. 捕获阶段（capturing phase）
2. 目标阶段（target phase）
3. 冒泡阶段（bubbling phase）
```

### 👉 举个例子

假设你点击了一个页面中的 `<button>`，这个按钮是嵌套在 `<div>` → `<body>` → `<html>` → `document` 中的。事件的传播路径大致如下：

#### 1️⃣ 捕获阶段：

- `document` → `html` → `body` → `div` → `button`

自最顶层元素到底层节点的一个过程

#### 2️⃣ 目标阶段：

- 到达真正被点击的元素（`button`）

#### 3️⃣ 冒泡阶段：

- `button` → `div` → `body` → `html` → `document`

📌 **事件会从外层往里走（捕获），到达目标，然后再从目标往外冒泡（冒泡）**
一般的事件侦听函数都是在在冒泡阶段执行, 例如`addEventListener()`函数默认在冒泡阶段进行操作

---

## ✅ 三、如何注册事件监听器

```js
element.addEventListener(type, listener, options);
```

参数说明：

- `type`：事件类型，如 `"click"`
- `listener`：回调函数
- `options`：

  - `capture: true` 表示监听捕获阶段
  - 默认是 `false`（监听冒泡阶段）

---

### 🔁 对比：监听冒泡还是捕获

```js
div.addEventListener("click", () => console.log("冒泡阶段"), false);
div.addEventListener("click", () => console.log("捕获阶段"), true);
```

## 阻止事件传播

### 🔹 阻止冒泡：

```js
event.stopPropagation();
```

只会阻止事件继续沿着冒泡链传播。

### 🔹 阻止捕获 + 冒泡（老浏览器）：

```js
event.cancelBubble = true; // 非标准，不推荐
```

### 🔹 阻止默认行为：

```js
event.preventDefault(); // 阻止超链接跳转、表单提交等默认动作
```

---

## ✅ 六、事件委托（Event Delegation）

事件冒泡是实现**事件委托**的基础：

```js
document.getElementById("list").addEventListener("click", function (e) {
  if (e.target.tagName === "LI") {
    console.log("你点击了某个 li");
  }
});
```

- 父元素绑定事件，子元素触发时冒泡到父元素处理
- 减少事件绑定，提高性能

---

## 为什么事件处理总在冒泡阶段

- 默认在冒泡阶段
- 事件委托想要实现，需要在冒泡阶段
- 符合内层优先执行，外层在处理的设计逻辑
- 早期 IE 浏览器只支持冒泡阶段
